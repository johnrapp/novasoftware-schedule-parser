<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>

<style type="text/css">
	
	.fill {
		position: absolute;
		font-size: 10px;
		border: 1px solid black;
		box-sizing: border-box;
	}

	.text {
		position: absolute;
		overflow: hidden;
	}

</style>

<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript">
	function getQueryParameterByName(name) {
	    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
	    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
	        results = regex.exec(location.search);
	    return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
	}
</script>
<body>

<div id="container" width="1000" height="1000"></div>
<!-- <canvas width="1000" height="1000"></canvas> -->

<script type="text/javascript">

var mode = getQueryParameterByName('mode');

var file = mode || 'debug';

$.getJSON(file + '.txt', function(data) {
	var container = $('#container');

	var sx = 7, sy = 15;

	function renderFillsAndTexts() {
		data.fills
		.filter(x => x.w*x.h > 2)
		.forEach(function(fill) {
			$('<div class="fill">').css({
				background: fill.oc || '#f00',
				left: fill.x * sx + "px",
				top: fill.y * sy + "px"
			})
			.width(fill.w * sx)
			.height(fill.h * sy)
			.appendTo(container)
		});

		data.texts.forEach(function(text) {

			$('<div class="text">').css({
				background: '#000',
				left: text.x * sx + "px",
				top: text.y * sy + "px"
			})
			.width(text.w * sx)
			.height(text.h * sy)
			// .text(text.text)
			.appendTo(container)

		});
	}

	function renderLessons() {
		data.forEach(function(lesson) {
			var fill = lesson.fill;
			$('<div class="fill">').css({
				background: fill.oc || '#f00',
				left: fill.x * sx + "px",
				top: fill.y * sy + "px"
			})
			.width(fill.w * sx)
			.height(fill.h * sy)
			// .text(lesson.rows.join(','))
			.text((lesson.startTime && lesson.startTime.text) + ', ' + (lesson.endTime && lesson.endTime.text))
			.appendTo(container)
		});
	}

	switch (mode) {
		case 'fills_and_texts':
			renderFillsAndTexts();
			break;
		case 'lessons':
			renderLessons();
			break;
	}

})
	
</script>

</body>
</html>